/* =============================================================================
   Markdown UI - CanonRS
   Family F: Data & Media
   ============================================================================= */

/* ── Container ──────────────────────────────────────────────────────────────── */

[data-markdown] {
  max-width: var(--markdown-max-width);
  margin: 0 auto;
  font-family: var(--markdown-font-family);
  font-size: var(--markdown-font-size);
  line-height: var(--markdown-line-height);
  color: var(--markdown-fg);
}

/* ── Toolbar ────────────────────────────────────────────────────────────────── */

[data-md-toolbar] {
  display: flex;
  align-items: center;
  gap: var(--markdown-toolbar-gap);
  padding: var(--markdown-toolbar-padding-y) var(--markdown-toolbar-padding-x);
  border-bottom: 1px solid var(--markdown-toolbar-border-color);
  margin-bottom: var(--space-md);
}

[data-md-toolbar-item] {
  display: inline-flex;
  align-items: center;
  gap: var(--space-xs);
  padding: var(--markdown-toolbar-item-padding-y) var(--markdown-toolbar-item-padding-x);
  border-radius: var(--markdown-toolbar-item-radius);
  border: 1px solid var(--markdown-toolbar-item-border-color);
  background: transparent;
  color: var(--markdown-toolbar-item-fg);
  font-size: var(--font-size-sm);
  cursor: pointer;
  transition: all var(--motion-duration-fast) var(--motion-ease-standard);
}

[data-md-toolbar-item]:hover {
  background: var(--markdown-toolbar-item-bg-hover);
  color: var(--markdown-toolbar-item-fg-hover);
}

/* ── TOC ────────────────────────────────────────────────────────────────────── */

[data-md-toc] {
  overflow: hidden;
  border: 1px solid var(--markdown-toc-border-color);
  border-radius: var(--markdown-toc-border-radius);
  margin-bottom: var(--space-lg);
  transition:
    max-height var(--markdown-toc-transition-duration) var(--markdown-toc-transition-ease),
    padding var(--markdown-toc-transition-duration) var(--markdown-toc-transition-ease);
}

[data-md-toc][data-state="open"] {
  max-height: 1000px;
  padding: var(--markdown-toc-padding);
}

[data-md-toc][data-state="closed"] {
  max-height: 0;
  padding: 0;
  border-color: transparent;
}

[data-toc-list] {
  list-style: none;
  padding: 0;
  margin: 0;
}

[data-toc-item] {
  margin-bottom: var(--space-2xs);
}

[data-toc-item][data-level="1"] { padding-left: 0; }
[data-toc-item][data-level="2"] { padding-left: var(--space-sm); }
[data-toc-item][data-level="3"] { padding-left: var(--markdown-toc-indent-l3); }
[data-toc-item][data-level="4"] { padding-left: var(--markdown-toc-indent-l4); }
[data-toc-item][data-level="5"] { padding-left: var(--markdown-toc-indent-l5); }

[data-toc-link] {
  display: block;
  font-size: var(--markdown-toc-link-font-size);
  color: var(--markdown-toc-link-fg);
  text-decoration: none;
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  border-left: 2px solid transparent;
  transition: all var(--motion-duration-fast) var(--motion-ease-standard);
}

[data-toc-link]:hover {
  color: var(--markdown-toc-link-fg-hover);
  background: var(--markdown-toc-link-bg-hover);
}


/* ── Content ────────────────────────────────────────────────────────────────── */

[data-md-content] { min-width: 0; }

[data-markdown] h1 {
  font-size: var(--font-size-3xl);
  font-weight: var(--font-weight-bold);
  line-height: var(--line-height-tight);
  color: var(--markdown-heading-fg);
  margin-top: var(--space-2xl);
  margin-bottom: var(--space-lg);
}

[data-markdown] h2 {
  font-size: var(--font-size-2xl);
  font-weight: var(--font-weight-bold);
  line-height: var(--line-height-tight);
  color: var(--markdown-heading-fg);
  margin-top: var(--space-3xl);
  margin-bottom: var(--space-lg);
  border-bottom: 1px solid var(--markdown-hr-color);
  padding-bottom: var(--space-sm);
}

[data-markdown] h3 {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
  color: var(--markdown-heading-fg);
  margin-top: var(--space-2xl);
  margin-bottom: var(--space-md);
}

[data-markdown] h4 {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--markdown-heading-fg);
  margin-top: var(--space-xl);
  margin-bottom: var(--space-sm);
}

[data-markdown] h5,
[data-markdown] h6 {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-semibold);
  color: var(--markdown-heading-fg);
  margin-top: var(--space-lg);
  margin-bottom: var(--space-xs);
}

[data-markdown] p {
  margin-bottom: var(--space-md);
  color: var(--markdown-fg);
}

[data-markdown] a,
[data-md-link] {
  color: var(--markdown-link-fg);
  text-decoration: underline;
  text-underline-offset: var(--space-2xs);
  transition: opacity var(--motion-duration-fast) var(--motion-ease-standard);
}

[data-markdown] a:hover { opacity: 0.8; }

[data-markdown] ul,
[data-markdown] ol {
  margin-bottom: var(--space-md);
  padding-left: var(--space-xl);
}

[data-markdown] li        { margin-bottom: var(--space-xs); }
[data-markdown] ul li     { list-style-type: disc; }
[data-markdown] ol li     { list-style-type: decimal; }

[data-markdown] blockquote,
[data-md-blockquote] {
  border-left: var(--space-xs) solid var(--markdown-blockquote-border);
  padding-left: var(--space-lg);
  margin: var(--space-lg) 0;
  color: var(--markdown-blockquote-fg);
  font-style: italic;
}

[data-md-inline-code] {
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  background: var(--markdown-inline-code-bg);
  color: var(--markdown-inline-code-fg);
  padding: var(--space-2xs) var(--space-xs);
  border-radius: var(--markdown-inline-code-radius);
  border: 1px solid var(--theme-surface-border-muted);
}

[data-markdown] hr,
[data-md-hr] {
  border: none;
  border-top: 1px solid var(--markdown-hr-color);
  margin: var(--space-2xl) 0;
}

[data-markdown] img,
[data-md-img] {
  max-width: 100%;
  height: auto;
  border-radius: var(--radius-md);
  margin: var(--space-lg) 0;
}

[data-markdown] strong { font-weight: var(--font-weight-bold); }
[data-markdown] em     { font-style: italic; }
[data-markdown] del    { text-decoration: line-through; }

/* ── Tables inside markdown ──────────────────────────────────────────────────── */

[data-md-table] {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: var(--space-lg);
  font-size: var(--font-size-sm);
}

[data-md-thead] { background: var(--table-header-bg); }

[data-md-table] th {
  padding: var(--table-cell-padding-y) var(--table-cell-padding-x);
  text-align: left;
  font-weight: var(--table-header-font-weight);
  border-bottom: 1px solid var(--table-border-color);
}

[data-md-td] {
  padding: var(--table-cell-padding-y) var(--table-cell-padding-x);
  border-bottom: 1px solid var(--theme-surface-border-muted);
}

/* ── Code blocks inside markdown ─────────────────────────────────────────────── */

[data-markdown] [data-code-block] {
  margin-bottom: var(--space-lg);
}

/* ── Layout ──────────────────────────────────────────────────────────────────── */

[data-md-layout] {
  display: flex;
  flex-direction: column;
  gap: var(--space-lg);
}

[data-markdown][data-toc-position="sidebar"] [data-md-layout] {
  display: grid;
  grid-template-columns: 260px 1fr;
  gap: var(--space-2xl);
  align-items: start;
}

[data-md-toc-sidebar] {
  position: sticky;
  top: var(--space-2xl);
  max-height: calc(100vh - var(--space-3xl));
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-width: thin;
  scrollbar-color: var(--theme-surface-border-muted) transparent;
}

[data-md-toc-sidebar]::-webkit-scrollbar {
  width: 6px;
}

[data-md-toc-sidebar]::-webkit-scrollbar-track {
  background: transparent;
}

[data-md-toc-sidebar]::-webkit-scrollbar-thumb {
  background: var(--theme-surface-border-muted);
  border-radius: var(--radius-full);
}

/* ── Ancestor State ──────────────────────────────────────────────────────────── */


/* ── Smooth Scroll ───────────────────────────────────────────────────────────── */

html { scroll-behavior: smooth; }

[data-md-toc-title] {
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--theme-surface-fg-muted);
  margin-bottom: var(--space-sm);
}

/* Markdown Toolbar */
[data-markdown-toolbar] {
  display: flex;
  gap: var(--space-2);
  padding: var(--space-2);
  background: var(--theme-surface-elevated);
  border-bottom: 1px solid var(--theme-surface-border);
}

[data-toolbar-toggle] {
  padding: var(--space-2) var(--space-4);
  background: var(--theme-surface-bg);
  border: 1px solid var(--theme-surface-border);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--motion-duration-fast);
  font-size: var(--font-size-3);
}

[data-toolbar-toggle]:hover {
  background: var(--theme-surface-elevated);
}

[data-toolbar-toggle][data-active="false"] {
  opacity: 0.5;
}

/* Hide TOC when toggled */
[data-hide-toc="true"] aside[data-md-toc-sidebar] {
  display: none;
}


/* Line Numbers via CSS */
[data-show-line-numbers="true"] [data-md-content] pre {
  padding-left: 4em;
  background-image: 
    linear-gradient(to bottom, var(--theme-surface-border) 1px, transparent 1px);
  background-size: 100% 1.5em;
  background-position: 0 0;
  counter-reset: line;
  position: relative;
}

[data-show-line-numbers="true"] [data-md-content] pre::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  width: 3.5em;
  height: 100%;
  background: var(--theme-surface-muted);
  border-right: 1px solid var(--theme-surface-border);
}
